Функция get_product_list предназначена для получения списка товаров из магазина Ozon. Она отправляет запрос к API Ozon с использованием предоставленных идентификаторов клиента и токена продавца. В ответе API содержится информация о товарах, которая затем извлекается и возвращается функцией. Таким образом, эта функция позволяет получить актуальный список товаров, доступных в магазине Ozon, используя предоставленные учетные данные.

Функция get_offer_ids предназначена для получения списка артикулов товаров из магазина Ozon. Она отправляет запросы к API Ozon, используя предоставленные идентификаторы клиента и продавца, чтобы получить информацию о товарах. После получения данных функция извлекает артикулы каждого товара и возвращает их в виде списка.

Функция update_price предназначена для обновления цен товаров в магазине Ozon. Она отправляет запросы к API Ozon с предоставленными ценами, идентификаторами клиента и продавца. После получения ответа от API функция проверяет успешность операции и возвращает результат в виде объекта.

Функция update_stocks предназначена для обновления информации о наличии товаров в магазине Ozon. Она отправляет запросы к API Ozon с предоставленными данными о наличии товаров, используя идентификатор клиента и токен продавца для авторизации. После получения ответа от API функция проверяет успешность операции и возвращает результат в виде объекта.

Функция download_stock предназначена для скачивания файла с остатками товаров с сайта Casio, распаковки архива и извлечения данных о часах в список. Она отправляет запрос на скачивание файла с сайта Casio, затем распаковывает архив и извлекает данные из Excel-файла, начиная с 18 строки. После обработки данных функция удаляет временный файл и возвращает список остатков товаров.

Функция create_stocks предназначена для формирования списка остатков товаров на складе. Она принимает на вход данные об остатках часов и список идентификаторов предложений. Сначала создаётся пустой список для хранения информации об остатках. Затем функция проходит по каждому элементу в данных об остатках часов и проверяет, присутствует ли идентификатор этого товара в списке предложений. Если идентификатор найден, функция получает количество товара. Если количество больше 10, устанавливается значение остатка в 100; если количество равно 1, устанавливается остаток в 0; в остальных случаях устанавливается остаток, равный указанному количеству. Затем в список остатков добавляется словарь с идентификатором предложения и соответствующим остатком, после чего этот идентификатор удаляется из списка предложений. После обработки всех элементов функция проходит по оставшимся идентификаторам в списке предложений и добавляет их в список остатков с нулевым значением остатка. В конце функция возвращает сформированный список остатков.

Функция create_prices предназначена для создания списка цен на товары. Она принимает на вход данные об остатках часов и список идентификаторов предложений. Сначала создаётся пустой список для хранения информации о ценах. Затем функция проходит по каждому элементу в данных об остатках часов и проверяет, присутствует ли идентификатор этого товара в списке предложений. Если идентификатор найден, функция создаёт словарь с информацией о цене, включая код валюты, идентификатор предложения, старую цену, установленную в 0, и новую цену, полученную с помощью функции преобразования цены. Затем этот словарь добавляется в список цен. В конце функция возвращает сформированный список цен.

upload_prices: Эта функция предназначена для обновления цен на товары. Сначала она получает список идентификаторов предложений, затем формирует список новых цен на основе имеющихся данных о товарах. Далее она разбивает этот список на части по 1000 элементов и отправляет каждую часть на обновление. В итоге функция возвращает полный список обновлённых цен.

upload_stocks: Эта функция предназначена для обновления информации об остатках товаров. Сначала она получает список идентификаторов предложений, затем формирует список остатков на основе имеющихся данных о товарах. Далее она разбивает этот список на части по 100 элементов и отправляет каждую часть на обновление. После этого она фильтрует список, оставляя только те товары, у которых остаток не равен нулю. В итоге функция возвращает два списка: один с товарами, у которых есть остатки, и полный список всех остатков.

Функция main извлекает идентификаторы клиента и токен продавца из переменных окружения. Затем она получает список идентификаторов предложений и загружает данные об остатках товаров. После этого формируются и обновляются данные об остатках и ценах товаров, причём обновления выполняются пакетами для оптимизации. В случае возникновения ошибок, таких как превышение времени ожидания или проблемы с соединением, программа выводит соответствующие сообщения.
